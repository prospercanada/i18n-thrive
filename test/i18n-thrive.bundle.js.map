{
  "version": 3,
  "sources": ["../src/core/i18n-toggle.js", "../src/core/i18n.js", "../src/features/doit.js", "../src/features/dynamic-i18n.js", "../src/index.js"],
  "sourcesContent": ["// src/core/i18n-toggle.js\r\nlet _inited = false;\r\nconst LANG_STORAGE_KEY = \"preferredLang\";\r\nconst LANGS = [\r\n  { code: \"en\", label: \"English\", htmlLang: \"en-CA\" },\r\n  { code: \"fr\", label: \"Fran\u00E7ais\", htmlLang: \"fr-CA\" },\r\n];\r\n\r\nconst normalize = (v) =>\r\n  String(v || \"en\").toLowerCase() === \"fr\" ? \"fr\" : \"en\";\r\n\r\nexport function getCurrentLang() {\r\n  try {\r\n    return normalize(localStorage.getItem(LANG_STORAGE_KEY));\r\n  } catch {\r\n    return \"en\";\r\n  }\r\n}\r\n\r\nfunction setDocumentLang(code) {\r\n  const c = normalize(code);\r\n  document.documentElement.setAttribute(\"data-lang\", c);\r\n  document.documentElement.setAttribute(\"lang\", c === \"fr\" ? \"fr-CA\" : \"en-CA\");\r\n}\r\n\r\nexport async function setLanguage(lang, { notifyAlways = false } = {}) {\r\n  const next = normalize(lang);\r\n  const current = document.documentElement.getAttribute(\"data-lang\") || \"en\";\r\n\r\n  try {\r\n    localStorage.setItem(LANG_STORAGE_KEY, next);\r\n  } catch {}\r\n\r\n  if (current !== next) setDocumentLang(next);\r\n\r\n  // Update your DOM-tag translator first\r\n  if (window.ThriveI18n?.setLangNoReload) {\r\n    try {\r\n      await window.ThriveI18n.setLangNoReload(next);\r\n    } catch (err) {\r\n      console.error(\"[i18n] setLangNoReload failed:\", err);\r\n    }\r\n  }\r\n\r\n  // NEW: i18next bridge (for React header/footer/body)\r\n  if (window.i18next?.changeLanguage) {\r\n    try {\r\n      await window.i18next.changeLanguage(next);\r\n    } catch (err) {\r\n      console.warn(\"[i18n] i18next.changeLanguage failed:\", err);\r\n    }\r\n  }\r\n\r\n  if (notifyAlways || current !== next) {\r\n    window.dispatchEvent(\r\n      new CustomEvent(\"langchange\", { detail: { lang: next } })\r\n    );\r\n  }\r\n}\r\n\r\n// ---------- DOM: toggle button ----------\r\nfunction findNav() {\r\n  return document.querySelector(\".nav.navbar-nav\");\r\n}\r\n\r\nfunction renderToggle(currentLang) {\r\n  const nav = findNav();\r\n  if (!nav) return;\r\n\r\n  nav.querySelectorAll(\"li[data-lang-toggle]\").forEach((li) => li.remove());\r\n\r\n  const other = LANGS.find((l) => l.code !== currentLang);\r\n  if (!other) return;\r\n\r\n  const li = document.createElement(\"li\");\r\n  li.setAttribute(\"data-lang-toggle\", \"true\");\r\n\r\n  const a = document.createElement(\"a\");\r\n  a.href = \"#\";\r\n  a.setAttribute(\"role\", \"button\");\r\n  a.setAttribute(\"aria-label\", `Switch to ${other.label}`);\r\n  a.dataset.toggleLang = other.code;\r\n  a.textContent = other.label;\r\n\r\n  li.appendChild(a);\r\n  nav.appendChild(li);\r\n\r\n  if (!nav.dataset.langToggleBound) {\r\n    nav.addEventListener(\"click\", (e) => {\r\n      const target = e.target.closest(\"[data-toggle-lang]\");\r\n      if (!target) return;\r\n      e.preventDefault();\r\n      const lang = target.dataset.toggleLang;\r\n      setLanguage(lang, { notifyAlways: true });\r\n      renderToggle(lang);\r\n    });\r\n    nav.dataset.langToggleBound = \"1\";\r\n  }\r\n}\r\n\r\n// observe DOM in case Thrive replaces the header/nav after partial updates\r\nlet _disconnectMo = null;\r\nfunction startObserver() {\r\n  if (_disconnectMo) return;\r\n  const mo = new MutationObserver(() => {\r\n    const nav = findNav();\r\n    if (nav && !nav.querySelector(\"li[data-lang-toggle]\")) {\r\n      renderToggle(getCurrentLang());\r\n    }\r\n  });\r\n  mo.observe(document.documentElement, { childList: true, subtree: true });\r\n  _disconnectMo = () => mo.disconnect();\r\n}\r\n\r\n// ---------- public init ----------\r\nexport function initToggle() {\r\n  if (_inited) return;\r\n  _inited = true;\r\n\r\n  const current = getCurrentLang();\r\n  setDocumentLang(current);\r\n\r\n  // NEW: align React/i18next on first load too\r\n  if (window.i18next?.changeLanguage) {\r\n    window.i18next\r\n      .changeLanguage(current)\r\n      .catch((e) =>\r\n        console.warn(\"[i18n] initial i18next.changeLanguage failed:\", e)\r\n      );\r\n  }\r\n\r\n  // Fire once so any dynamic listeners re-render\r\n  window.dispatchEvent(\r\n    new CustomEvent(\"langchange\", { detail: { lang: current } })\r\n  );\r\n\r\n  const ready = () => {\r\n    renderToggle(current);\r\n    startObserver();\r\n  };\r\n  if (document.readyState === \"loading\") {\r\n    document.addEventListener(\"DOMContentLoaded\", ready, { once: true });\r\n  } else {\r\n    ready();\r\n  }\r\n}\r\n\r\n// // src/core/i18n-toggle.js\r\n// let _inited = false;\r\n// const LANG_STORAGE_KEY = \"preferredLang\";\r\n// const LANGS = [\r\n//   { code: \"en\", label: \"English\", htmlLang: \"en-CA\" },\r\n//   { code: \"fr\", label: \"Fran\u00E7ais\", htmlLang: \"fr-CA\" },\r\n// ];\r\n\r\n// // ---------- small utils ----------\r\n// const normalize = (v) =>\r\n//   String(v || \"en\").toLowerCase() === \"fr\" ? \"fr\" : \"en\";\r\n\r\n// export function getCurrentLang() {\r\n//   try {\r\n//     return normalize(localStorage.getItem(LANG_STORAGE_KEY));\r\n//   } catch {\r\n//     return \"en\";\r\n//   }\r\n// }\r\n\r\n// function setDocumentLang(code) {\r\n//   const c = normalize(code);\r\n//   document.documentElement.setAttribute(\"data-lang\", c);\r\n//   document.documentElement.setAttribute(\"lang\", c === \"fr\" ? \"fr-CA\" : \"en-CA\");\r\n// }\r\n\r\n// export async function setLanguage(lang, { notifyAlways = false } = {}) {\r\n//   const next = normalize(lang);\r\n//   const current = document.documentElement.getAttribute(\"data-lang\") || \"en\";\r\n\r\n//   // persist\r\n//   try {\r\n//     localStorage.setItem(LANG_STORAGE_KEY, next);\r\n//   } catch {}\r\n\r\n//   if (current !== next) setDocumentLang(next);\r\n\r\n//   // optional: if you have a no-reload renderer\r\n//   if (window.ThriveI18n?.setLangNoReload) {\r\n//     try {\r\n//       await window.ThriveI18n.setLangNoReload(next);\r\n//     } catch (err) {\r\n//       console.error(\"[i18n] setLangNoReload failed:\", err);\r\n//     }\r\n//   }\r\n\r\n//   if (notifyAlways || current !== next) {\r\n//     window.dispatchEvent(\r\n//       new CustomEvent(\"langchange\", { detail: { lang: next } })\r\n//     );\r\n//   }\r\n// }\r\n\r\n// // ---------- DOM: toggle button ----------\r\n// function findNav() {\r\n//   return document.querySelector(\".nav.navbar-nav\");\r\n// }\r\n\r\n// // create (or replace) the single toggle item\r\n// function renderToggle(currentLang) {\r\n//   const nav = findNav();\r\n//   if (!nav) return;\r\n\r\n//   // remove any previous toggles we added\r\n//   nav.querySelectorAll(\"li[data-lang-toggle]\").forEach((li) => li.remove());\r\n\r\n//   const other = LANGS.find((l) => l.code !== currentLang);\r\n//   if (!other) return;\r\n\r\n//   const li = document.createElement(\"li\");\r\n//   li.setAttribute(\"data-lang-toggle\", \"true\");\r\n\r\n//   const a = document.createElement(\"a\");\r\n//   a.href = \"#\";\r\n//   a.setAttribute(\"role\", \"button\");\r\n//   a.setAttribute(\"aria-label\", `Switch to ${other.label}`);\r\n//   a.dataset.toggleLang = other.code;\r\n//   a.textContent = other.label;\r\n\r\n//   li.appendChild(a);\r\n//   nav.appendChild(li);\r\n\r\n//   // one nav-level click handler (idempotent)\r\n//   if (!nav.dataset.langToggleBound) {\r\n//     nav.addEventListener(\"click\", (e) => {\r\n//       const target = e.target.closest(\"[data-toggle-lang]\");\r\n//       if (!target) return;\r\n//       e.preventDefault();\r\n//       const lang = target.dataset.toggleLang;\r\n//       setLanguage(lang, { notifyAlways: true });\r\n//       renderToggle(lang); // refresh to show the other choice\r\n//     });\r\n//     nav.dataset.langToggleBound = \"1\";\r\n//   }\r\n// }\r\n\r\n// // observe DOM in case Thrive replaces the header/nav after partial updates\r\n// let _disconnectMo = null;\r\n// function startObserver() {\r\n//   if (_disconnectMo) return;\r\n//   const mo = new MutationObserver(() => {\r\n//     // if nav exists but toggle is missing, re-render\r\n//     const nav = findNav();\r\n//     if (nav && !nav.querySelector(\"li[data-lang-toggle]\")) {\r\n//       renderToggle(getCurrentLang());\r\n//     }\r\n//   });\r\n//   mo.observe(document.documentElement, { childList: true, subtree: true });\r\n//   _disconnectMo = () => mo.disconnect();\r\n// }\r\n\r\n// // ---------- public init ----------\r\n// export function initToggle() {\r\n//   if (_inited) return;\r\n//   _inited = true;\r\n\r\n//   // set base lang (attrs + event) once on boot\r\n//   const current = getCurrentLang();\r\n//   setDocumentLang(current);\r\n//   // notify others on boot (so dynamic renderers can run)\r\n//   window.dispatchEvent(\r\n//     new CustomEvent(\"langchange\", { detail: { lang: current } })\r\n//   );\r\n\r\n//   // mount the toggle\r\n//   const ready = () => {\r\n//     renderToggle(current);\r\n//     startObserver();\r\n//   };\r\n//   if (document.readyState === \"loading\") {\r\n//     document.addEventListener(\"DOMContentLoaded\", ready, { once: true });\r\n//   } else {\r\n//     ready();\r\n//   }\r\n// }\r\n", "// src/core/i18n.js\r\nlet state = {\r\n  lang: \"en\",\r\n  catalogs: {},\r\n  opts: null, // { manifestUrl, namespaces, observeMutations }\r\n  observer: null,\r\n  ready: false,\r\n  pending: [],\r\n  isApplying: false,\r\n};\r\n\r\nconst STORE_KEY = \"preferredLang\";\r\nconst ATTRS = new Set([\r\n  \"aria-label\",\r\n  \"title\",\r\n  \"alt\",\r\n  \"placeholder\",\r\n  \"value\",\r\n  \"data-i18n-text\",\r\n  \"data-content\",\r\n  \"data-original-title\",\r\n]);\r\n\r\n// ----------------- utilities -----------------\r\nconst normalizeLang = (v) =>\r\n  String(v || \"en\").toLowerCase() === \"fr\" ? \"fr\" : \"en\";\r\n\r\nfunction setDocumentLang(lang) {\r\n  const code = normalizeLang(lang);\r\n  document.documentElement.setAttribute(\"data-lang\", code);\r\n  document.documentElement.setAttribute(\r\n    \"lang\",\r\n    code === \"fr\" ? \"fr-CA\" : \"en-CA\"\r\n  );\r\n  // Broadcast to any listeners (toggle, dynamic renderers, etc.)\r\n  window.dispatchEvent(\r\n    new CustomEvent(\"langchange\", { detail: { lang: code } })\r\n  );\r\n}\r\n\r\nfunction firstTextNode(el) {\r\n  const w = document.createTreeWalker(el, NodeFilter.SHOW_TEXT, {\r\n    acceptNode(n) {\r\n      return n.nodeValue && n.nodeValue.trim() ? 1 : 2;\r\n    },\r\n  });\r\n  return w.nextNode();\r\n}\r\n\r\nfunction sameHTML(a, b) {\r\n  if (a === b) return true;\r\n  return (\r\n    a.replace(/\\u00A0/g, \"&nbsp;\").trim() ===\r\n    b.replace(/\\u00A0/g, \"&nbsp;\").trim()\r\n  );\r\n}\r\n\r\nfunction setFirstText(el, txt) {\r\n  const tn = firstTextNode(el);\r\n  if (tn) {\r\n    if (tn.nodeValue !== txt) tn.nodeValue = txt;\r\n  } else if (el.textContent !== txt) {\r\n    el.textContent = txt;\r\n  }\r\n}\r\n\r\n// ----------------- fetch caches -----------------\r\nconst jsonCache = new Map(); // url -> Promise(json)\r\n// async function loadJSON(url) {\r\n//   if (jsonCache.has(url)) return jsonCache.get(url);\r\n//   const p = fetch(url, { cache: \"no-store\" }).then((r) => {\r\n//     if (!r.ok) throw new Error(`Failed to fetch ${url} (${r.status})`);\r\n//     return r.json();\r\n//   });\r\n//   jsonCache.set(url, p);\r\n//   return p;\r\n// }\r\n\r\n// ---- config ----\r\nconst jsonMem = new Map(); // url -> Promise(json) (in-memory de-dupe)\r\nconst JSON_TTL_MS = 1 * 1 * 60 * 1000; // 2 hours\r\nconst JSON_CACHE_PREFIX = \"i18n:json:\"; // localStorage key prefix\r\nconst LOG = false; // flip to true to see console logs\r\n\r\nfunction log(...a) {\r\n  if (LOG) console.log(\"[i18n json]\", ...a);\r\n}\r\n\r\nfunction lsGet(key) {\r\n  try {\r\n    return JSON.parse(localStorage.getItem(key) || \"null\");\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\nfunction lsSet(key, value) {\r\n  try {\r\n    localStorage.setItem(key, JSON.stringify(value));\r\n  } catch {}\r\n}\r\nfunction lsDel(key) {\r\n  try {\r\n    localStorage.removeItem(key);\r\n  } catch {}\r\n}\r\n\r\nfunction cacheKey(url) {\r\n  return JSON_CACHE_PREFIX + url;\r\n}\r\nfunction isFresh(ts, ttlMs) {\r\n  return typeof ts === \"number\" && Date.now() - ts < ttlMs;\r\n}\r\n\r\n/**\r\n * Fetch JSON with:\r\n *  - in-memory de-dupe\r\n *  - persistent cache (localStorage) with TTL\r\n *  - light retry/backoff for 429/transients\r\n */\r\nexport async function loadJSON(url, { ttlMs = JSON_TTL_MS, retries = 2 } = {}) {\r\n  // 0) return in-flight promise if any\r\n  if (jsonMem.has(url)) return jsonMem.get(url);\r\n\r\n  // 1) try fresh persistent cache\r\n  const k = cacheKey(url);\r\n  const cached = lsGet(k);\r\n  if (cached && isFresh(cached.ts, ttlMs)) {\r\n    log(\"HIT (persist)\", { url, ageMs: Date.now() - cached.ts });\r\n    const p = Promise.resolve(cached.data);\r\n    jsonMem.set(url, p);\r\n    return p;\r\n  }\r\n\r\n  // 2) else fetch (let the browser/CDN cache do its job; no \"no-store\")\r\n  const p = (async () => {\r\n    let lastErr;\r\n    for (let attempt = 0; attempt <= retries; attempt++) {\r\n      try {\r\n        log(\"FETCH\", { url, attempt });\r\n        const r = await fetch(url);\r\n        if (r.status === 429) {\r\n          // simple backoff (Retry-After is often 0 from GitHub Pages)\r\n          const delay = (attempt + 1) * 300;\r\n          log(\"429 backoff\", { url, delay });\r\n          await new Promise((res) => setTimeout(res, delay));\r\n          continue;\r\n        }\r\n        if (!r.ok) throw new Error(`HTTP ${r.status} for ${url}`);\r\n        const json = await r.json();\r\n        lsSet(k, { ts: Date.now(), data: json });\r\n        log(\"STORE (persist)\", { url });\r\n        return json;\r\n      } catch (e) {\r\n        lastErr = e;\r\n        if (attempt < retries) {\r\n          const delay = (attempt + 1) * 200;\r\n          log(\"retry\", { url, delay, error: String(e) });\r\n          await new Promise((res) => setTimeout(res, delay));\r\n        }\r\n      }\r\n    }\r\n\r\n    // 3) network failed\u2014fall back to stale cache if available\r\n    if (cached && cached.data) {\r\n      log(\"FALLBACK (stale)\", { url, ageMs: Date.now() - cached.ts });\r\n      return cached.data;\r\n    }\r\n    throw lastErr;\r\n  })();\r\n\r\n  jsonMem.set(url, p);\r\n  return p;\r\n}\r\n\r\n// Optional helpers\r\nexport function getJsonCacheInfo(url) {\r\n  const c = lsGet(cacheKey(url));\r\n  return c ? { ts: c.ts, ageMs: Date.now() - c.ts } : null;\r\n}\r\nexport function clearJsonCache(url) {\r\n  jsonMem.delete(url);\r\n  lsDel(cacheKey(url));\r\n}\r\n\r\nlet _manifestP = null;\r\nfunction getManifest(url) {\r\n  if (_manifestP) return _manifestP;\r\n  _manifestP = loadJSON(url);\r\n  return _manifestP;\r\n}\r\n\r\nconst nsMapCache = new Map(); // ns -> Promise(mapArray)\r\nasync function getMap(manifestUrl, ns) {\r\n  if (nsMapCache.has(ns)) return nsMapCache.get(ns);\r\n  const p = (async () => {\r\n    const manifest = await getManifest(manifestUrl);\r\n    const file = manifest[`${ns}.map`];\r\n    if (!file) return null;\r\n    const base = new URL(manifestUrl, location.origin);\r\n    const url = new URL(file, base).toString();\r\n    return loadJSON(url);\r\n  })();\r\n  nsMapCache.set(ns, p);\r\n  return p;\r\n}\r\n\r\nconst catalogCache = new Map(); // `${ns}:${lang}` -> Promise(object)\r\nasync function loadCatalogs(manifestUrl, namespaces, lang) {\r\n  const manifest = await getManifest(manifestUrl);\r\n  const base = new URL(manifestUrl, location.origin);\r\n  const promises = (namespaces || []).map((ns) => {\r\n    const key = `${ns}:${lang}`;\r\n    if (catalogCache.has(key)) return catalogCache.get(key);\r\n    const rel = manifest[`${ns}.${lang}`];\r\n    if (!rel) return Promise.resolve({});\r\n    const url = new URL(rel, base).toString();\r\n    const p = loadJSON(url);\r\n    catalogCache.set(key, p);\r\n    return p;\r\n  });\r\n  const parts = await Promise.all(promises);\r\n  return Object.assign({}, ...parts);\r\n}\r\n\r\n// ----------------- map attach (idempotent) -----------------\r\nfunction parseAttrPairs(str) {\r\n  const map = new Map();\r\n  if (!str) return map;\r\n  for (const part of str\r\n    .split(\",\")\r\n    .map((s) => s.trim())\r\n    .filter(Boolean)) {\r\n    const [attr, key] = part.split(\":\").map((s) => s.trim());\r\n    if (attr && key) map.set(attr, key);\r\n  }\r\n  return map;\r\n}\r\n\r\nfunction stringifyAttrPairs(map) {\r\n  return Array.from(map.entries())\r\n    .sort(([a], [b]) => (a > b ? 1 : a < b ? -1 : 0))\r\n    .map(([attr, key]) => `${attr}:${key}`)\r\n    .join(\",\");\r\n}\r\n\r\nfunction attachMaps(entries, root = document) {\r\n  for (const e of entries || []) {\r\n    const { selector, type, attr, key } = e || {};\r\n    if (!selector || !key) continue;\r\n\r\n    const nodes = root.querySelectorAll(selector);\r\n    if (!nodes.length) continue;\r\n\r\n    nodes.forEach((el) => {\r\n      if (type === \"text\" || type === \"html\") {\r\n        if (el.getAttribute(\"data-i18n\") !== key)\r\n          el.setAttribute(\"data-i18n\", key);\r\n        if (type === \"html\") el.setAttribute(\"data-i18n-html\", \"true\");\r\n      } else if (type === \"attr\" && attr) {\r\n        const cur = parseAttrPairs(el.getAttribute(\"data-i18n-attr\"));\r\n        cur.set(attr, key); // overwrite per-attr (no dupes)\r\n        const next = stringifyAttrPairs(cur);\r\n        if (el.getAttribute(\"data-i18n-attr\") !== next)\r\n          el.setAttribute(\"data-i18n-attr\", next);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n// ----------------- translation apply -----------------\r\nfunction applyToElement(el, tmap) {\r\n  // element text/html\r\n  const key = el.getAttribute(\"data-i18n\");\r\n  if (key && tmap[key] != null) {\r\n    const val = String(tmap[key]);\r\n    // \u2705 use language (and optionally length) \u2014 NOT just length\r\n    const sig = `${key}\u00A7${state.lang}\u00A7${val.length}`;\r\n\r\n    if (el.dataset.i18nApplied !== sig) {\r\n      if (el.hasAttribute(\"data-i18n-html\")) {\r\n        if (!sameHTML(el.innerHTML, val)) el.innerHTML = val;\r\n      } else {\r\n        const txt = val.replace(/&nbsp;/g, \"\\u00A0\");\r\n        const tn = firstTextNode(el);\r\n        const current = tn ? tn.nodeValue : el.textContent;\r\n        if (current !== txt) setFirstText(el, txt);\r\n      }\r\n      el.dataset.i18nApplied = sig; // \u2190 now changes when lang changes\r\n    }\r\n  }\r\n\r\n  //   if (key && tmap[key] != null) {\r\n  //     const val = String(tmap[key]);\r\n  //     const wantsHtml = el.hasAttribute(\"data-i18n-html\");\r\n  //     const sig = key + \"\u00A7\" + val.length;\r\n\r\n  //     if (el.dataset.i18nApplied !== sig) {\r\n  //       if (wantsHtml) {\r\n  //         if (!sameHTML(el.innerHTML, val)) el.innerHTML = val;\r\n  //       } else {\r\n  //         const txt = val.replace(/&nbsp;/g, \"\\u00A0\");\r\n  //         const tn = firstTextNode(el);\r\n  //         const current = tn ? tn.nodeValue : el.textContent;\r\n  //         if (current !== txt) setFirstText(el, txt);\r\n  //       }\r\n  //       el.dataset.i18nApplied = sig;\r\n  //     }\r\n  //   }\r\n\r\n  // attributes\r\n  const raw = el.getAttribute(\"data-i18n-attr\");\r\n  if (!raw) return;\r\n\r\n  const pairs = parseAttrPairs(raw);\r\n  for (const [attr, k] of pairs) {\r\n    if (!ATTRS.has(attr)) continue;\r\n    if (tmap[k] == null) continue;\r\n\r\n    let next = String(tmap[k]);\r\n    if (attr === \"data-i18n-text\") {\r\n      const txt = next.replace(/&nbsp;/g, \"\\u00A0\");\r\n      const tn = firstTextNode(el);\r\n      const current = tn ? tn.nodeValue : \"\";\r\n      if (current !== txt) {\r\n        if (tn) tn.nodeValue = txt;\r\n        else el.insertBefore(document.createTextNode(txt), el.firstChild);\r\n      }\r\n      continue;\r\n    }\r\n\r\n    if (\r\n      attr === \"title\" ||\r\n      attr === \"aria-label\" ||\r\n      attr === \"placeholder\" ||\r\n      attr === \"value\"\r\n    ) {\r\n      next = next.replace(/&nbsp;/g, \"\\u00A0\");\r\n    }\r\n    if (el.getAttribute(attr) !== next) el.setAttribute(attr, next);\r\n  }\r\n}\r\n\r\nfunction applyAll(tmap, root = document) {\r\n  if (!tmap) return;\r\n  root\r\n    .querySelectorAll(\"[data-i18n],[data-i18n-attr]\")\r\n    .forEach((el) => applyToElement(el, tmap));\r\n}\r\n\r\n// ----------------- main load/apply -----------------\r\nasync function loadAndApply(lang) {\r\n  if (!state?.opts?.manifestUrl) {\r\n    throw new Error(\"ThriveI18n not initialized: missing opts.manifestUrl\");\r\n  }\r\n\r\n  state.lang = normalizeLang(lang);\r\n  try {\r\n    localStorage.setItem(STORE_KEY, state.lang);\r\n  } catch {}\r\n\r\n  const { manifestUrl, namespaces } = state.opts;\r\n\r\n  // Tag maps (idempotent)\r\n  const maps = await Promise.all(\r\n    namespaces.map((ns) => getMap(manifestUrl, ns))\r\n  );\r\n  for (const map of maps) {\r\n    if (Array.isArray(map)) attachMaps(map, document);\r\n  }\r\n\r\n  // Load catalogs then apply\r\n  const tmap = await loadCatalogs(manifestUrl, namespaces, state.lang);\r\n  state.catalogs = tmap;\r\n\r\n  state.isApplying = true;\r\n  try {\r\n    applyAll(tmap);\r\n  } finally {\r\n    state.isApplying = false;\r\n  }\r\n}\r\n\r\n// ----------------- mutations (partial reloads) -----------------\r\nlet _flushScheduled = false;\r\nconst _pendingRoots = new Set();\r\n\r\nfunction scheduleRoot(el) {\r\n  if (!el || el.nodeType !== 1) return;\r\n  _pendingRoots.add(el);\r\n  if (!_flushScheduled) {\r\n    _flushScheduled = true;\r\n    queueMicrotask(flushPending);\r\n  }\r\n}\r\n\r\nasync function flushPending() {\r\n  _flushScheduled = false;\r\n  if (!_pendingRoots.size) return;\r\n\r\n  const roots = Array.from(_pendingRoots);\r\n  _pendingRoots.clear();\r\n\r\n  state.isApplying = true;\r\n  try {\r\n    // Tag maps in these subtrees\r\n    for (const root of roots) {\r\n      for (const ns of state.opts.namespaces) {\r\n        const map = await getMap(state.opts.manifestUrl, ns);\r\n        if (map) attachMaps(map, root);\r\n      }\r\n    }\r\n    // Apply within those roots\r\n    for (const root of roots) applyAll(state.catalogs, root);\r\n  } finally {\r\n    state.isApplying = false;\r\n  }\r\n}\r\n\r\n// ----------------- public API -----------------\r\nexport async function initI18n(opts) {\r\n  state.opts = Object.assign(\r\n    { namespaces: [\"profile\"], observeMutations: true, manifestUrl: \"\" },\r\n    opts || {}\r\n  );\r\n  if (!state.opts.manifestUrl) throw new Error(\"manifestUrl required\");\r\n\r\n  // base lang\r\n  const initial = normalizeLang(localStorage.getItem(STORE_KEY) || \"en\");\r\n  setDocumentLang(initial);\r\n  await loadAndApply(initial);\r\n  state.ready = true;\r\n\r\n  // React to cross-tab changes\r\n  window.addEventListener(\"storage\", (e) => {\r\n    if (e.key === STORE_KEY && e.newValue && e.newValue !== state.lang) {\r\n      setLangNoReload(e.newValue);\r\n    }\r\n  });\r\n\r\n  // Observe for partial updates\r\n  if (state.opts.observeMutations) {\r\n    if (state.observer) state.observer.disconnect();\r\n    state.observer = new MutationObserver((records) => {\r\n      if (state.isApplying) return; // ignore our own writes\r\n      for (const m of records) {\r\n        if (m.type === \"childList\") {\r\n          m.addedNodes.forEach((n) => scheduleRoot(n));\r\n        } else if (m.type === \"attributes\") {\r\n          // if our flags got added on an element, refresh that element's subtree\r\n          scheduleRoot(m.target);\r\n        }\r\n      }\r\n    });\r\n    state.observer.observe(document.documentElement, {\r\n      subtree: true,\r\n      childList: true,\r\n      attributes: true,\r\n      attributeFilter: [\"data-i18n\", \"data-i18n-attr\", \"data-i18n-html\"],\r\n    });\r\n  }\r\n}\r\n\r\nexport async function setLangNoReload(next) {\r\n  // reflect intent immediately for CSS/a11y\r\n  setDocumentLang(next);\r\n\r\n  if (!state.ready) {\r\n    state.pending.push(next);\r\n    return;\r\n  }\r\n  await loadAndApply(next);\r\n}\r\n\r\nexport function t(key) {\r\n  return state.catalogs[key] ?? key;\r\n}\r\n\r\nexport function fmtNumber(n, o) {\r\n  return new Intl.NumberFormat(\r\n    state.lang === \"fr\" ? \"fr-CA\" : \"en-CA\",\r\n    o\r\n  ).format(n);\r\n}\r\n\r\nexport function fmtDate(d, o) {\r\n  const dt = d instanceof Date ? d : new Date(d);\r\n  return new Intl.DateTimeFormat(\r\n    state.lang === \"fr\" ? \"fr-CA\" : \"en-CA\",\r\n    o\r\n  ).format(dt);\r\n}\r\n\r\nexport function __debug() {\r\n  return {\r\n    lang: state.lang,\r\n    ready: state.ready,\r\n    hasObserver: !!state.observer,\r\n    namespaces: state.opts?.namespaces || [],\r\n    catalogKeys: Object.keys(state.catalogs).length,\r\n  };\r\n}\r\n\r\nexport function destroy() {\r\n  if (state.observer) state.observer.disconnect();\r\n  state = {\r\n    lang: \"en\",\r\n    catalogs: {},\r\n    opts: null,\r\n    observer: null,\r\n    ready: false,\r\n    pending: [],\r\n    isApplying: false,\r\n  };\r\n  _manifestP = null;\r\n  jsonCache.clear();\r\n  nsMapCache.clear();\r\n  catalogCache.clear();\r\n}\r\n\r\n// expose for non-module callers (toggle, console, etc.)\r\nif (typeof window !== \"undefined\") {\r\n  window.ThriveI18n = {\r\n    init: initI18n,\r\n    setLangNoReload,\r\n    t,\r\n    fmtNumber,\r\n    fmtDate,\r\n    __debug,\r\n    get ready() {\r\n      return state.ready;\r\n    },\r\n  };\r\n}\r\n", "// src/features/doit.js\r\n// Utilities + WebForms hooks for Thrive i18n. No side effects on import.\r\n\r\nconst dbg = (m, o) => console.log(\"[i18n]\", m, o ?? \"\");\r\n\r\n// ----- optional helpers still used elsewhere -----\r\nexport function formatCount(keyBase, count) {\r\n  const k = count === 1 ? `${keyBase}.one` : `${keyBase}.other`;\r\n  const tpl =\r\n    window.ThriveI18n?.t?.(k) ||\r\n    window.ThriveI18n?.t?.(`${keyBase}.other`) ||\r\n    \"{count}\";\r\n  return String(tpl).replace(\"{count}\", String(count));\r\n}\r\nexport function updateCountAt(selector, keyBase) {\r\n  const el = document.querySelector(selector);\r\n  if (!el) return;\r\n  const m = (el.textContent || \"\").match(/\\d+/);\r\n  if (!m) return;\r\n  const n = parseInt(m[0], 10);\r\n  el.textContent = formatCount(keyBase, n);\r\n}\r\n\r\n// ----- internal url helpers -----\r\nfunction getParamCI(url, name) {\r\n  const target = name.toLowerCase();\r\n  for (const [k, v] of url.searchParams.entries()) {\r\n    if (k.toLowerCase() === target) return v;\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * Decide which namespaces to load based on the current path + query.\r\n * Keep this as your single routing table.\r\n */\r\nexport function pickNamespaces(currentUrlOrPath = location.href) {\r\n  const url =\r\n    typeof currentUrlOrPath === \"string\"\r\n      ? new URL(currentUrlOrPath, location.origin)\r\n      : currentUrlOrPath instanceof URL\r\n      ? currentUrlOrPath\r\n      : new URL(location.href);\r\n\r\n  const rawPath = (url.pathname || \"/\").replace(/\\/{2,}/g, \"/\");\r\n  const path = rawPath.replace(/^\\/sandboxmicrosite(?=\\/|$)/i, \"\") || \"/\";\r\n  const section = (getParamCI(url, \"section\") || \"\").trim().toLowerCase();\r\n\r\n  // Header/footer are cheap and ubiquitous\r\n  const out = new Set([\"header\"]);\r\n  const ENABLE_I18N = true; // set false to disable all translations\r\n  const ALLOWED = new Set([\r\n    \"header\",\r\n    \"profile\",\r\n    \"login\",\r\n    \"community\",\r\n    \"networkMembers\",\r\n  ]);\r\n\r\n  const add = function (ns) {\r\n    if (!ENABLE_I18N || !ns) return;\r\n    var list = Array.isArray(ns) ? ns : [ns];\r\n    for (var i = 0; i < list.length; i++) {\r\n      var n = list[i];\r\n      if (n && ALLOWED.has(n)) out.add(n); // <-- use Set.has(...)\r\n    }\r\n  };\r\n  // const add = (ns) => {\r\n  //   if (!ns) return;\r\n  //   (Array.isArray(ns) ? ns : [ns]).forEach((n) => n && out.add(n));\r\n  // };\r\n\r\n  // Profile-ish\r\n  if (/^\\/profile(?:\\/|$)/i.test(path) || /^\\/people(?:\\/|$)/i.test(path))\r\n    add(\"profile\");\r\n  if (/^\\/profile\\/connections\\/contacts(?:\\/|$)/i.test(path))\r\n    add(\"connections\");\r\n  if (/^\\/profile\\/connections\\/communities(?:\\/|$)/i.test(path))\r\n    add(\"communities\");\r\n  if (/^\\/profile\\/connections\\/communitiesnode(?:\\/|$)/i.test(path))\r\n    add(\"communitiesNode\");\r\n  if (/^\\/profile\\/connections\\/following-connections(?:\\/|$)/i.test(path))\r\n    add(\"following\");\r\n\r\n  if (/^\\/profile\\/contributions\\/contributions-summary(?:\\/|$)/i.test(path))\r\n    add(\"contribSummary\");\r\n  if (\r\n    /^\\/profile\\/contributions\\/contributions-achievements(?:\\/|$)/i.test(path)\r\n  )\r\n    add(\"contribAchievements\");\r\n  if (/^\\/profile\\/contributions\\/contributions-list(?:\\/|$)/i.test(path))\r\n    add(\"contribList\");\r\n\r\n  if (/^\\/profile\\/myaccount\\/changepassword(?:\\/|$)/i.test(path))\r\n    add(\"accountChangePassword\");\r\n  if (/^\\/profile\\/myaccount\\/mysignature(?:\\/|$)/i.test(path))\r\n    add(\"accountSignature\");\r\n  if (/^\\/profile\\/myaccount\\/inbox(?:\\/|$)/i.test(path)) add(\"accountInbox\");\r\n  if (/^\\/profile\\/myaccount\\/my-settings(?:\\/|$)/i.test(path)) {\r\n    const map = {\r\n      privacy: \"accountSettingsPrivacy\",\r\n      email: \"accountSettingsEmail\",\r\n      rssfeeds: \"accountSettingsRss\",\r\n      subscriptions: \"accountSettingsSubscriptions\",\r\n    };\r\n    add(map[section]);\r\n  }\r\n\r\n  // Directory\r\n  if (/^\\/network\\/members(?:\\/|$)/i.test(path)) add(\"networkMembers\");\r\n\r\n  // Top-level statics\r\n  if (/^\\/contactus(?:\\/|$)/i.test(path)) add(\"contact\");\r\n  if (/^\\/login(?:\\/|$)/i.test(path)) add(\"login\");\r\n  if (/^\\/participate\\/postmessage(?:\\/|$)/i.test(path)) add(\"postMessage\");\r\n  if (/^\\/participate\\/add-new-entry(?:\\/|$)/i.test(path)) add(\"addLibrary\");\r\n  if (/^\\/events\\/calendar(?:\\/|$)/i.test(path)) add(\"eventsCalendar\");\r\n\r\n  // Communities\r\n  if (/^\\/communities\\/[^/]+(?:\\/|$)/i.test(path)) add(\"community\");\r\n\r\n  if (/^\\/communities\\/mycommunities(?:\\/|$)/i.test(path))\r\n    out.add(\"communityMy\");\r\n\r\n  const inviteRe =\r\n    /^\\/communities(?:\\/community-home)?\\/invite-community(?:\\/digestviewer)?(?:\\/|$)/i;\r\n  if (inviteRe.test(path)) add(\"communityInvite\");\r\n  if (/^\\/communities\\/community-home\\/digestviewer(?:\\/|$)/i.test(path))\r\n    add(\"communityDigest\");\r\n  if (/^\\/communities\\/community-home\\/librarydocuments(?:\\/|$)/i.test(path))\r\n    add(\"communityLibrary\");\r\n  if (\r\n    /^\\/communities\\/community-home\\/recent-community-events(?:\\/|$)/i.test(\r\n      path\r\n    )\r\n  )\r\n    add(\"communityEvents\");\r\n  if (/^\\/communities\\/community-home\\/community-members(?:\\/|$)/i.test(path))\r\n    add(\"communityMembers\");\r\n\r\n  return Array.from(out);\r\n}\r\n\r\n/**\r\n * Install PRM / __doPostBack hooks once.\r\n * On partial updates, we just re-apply the current language.\r\n * The i18n module\u2019s MutationObserver will (re)tag and (re)apply in changed subtrees.\r\n */\r\nexport function installWebFormsHooks() {\r\n  let installed = false;\r\n\r\n  const reapply = () => {\r\n    const lang =\r\n      window.ThriveI18n?.__debug?.().lang ||\r\n      document.documentElement.getAttribute(\"data-lang\") ||\r\n      localStorage.getItem(\"preferredLang\") ||\r\n      \"en\";\r\n    // Re-apply translations for current lang (maps + catalogs are already cached)\r\n    window.ThriveI18n?.setLangNoReload?.(lang);\r\n    dbg(\"re-applied after partial postback\", { lang });\r\n  };\r\n\r\n  function wire() {\r\n    if (installed) return true;\r\n    if (window.Sys?.WebForms?.PageRequestManager) {\r\n      const prm = window.Sys.WebForms.PageRequestManager.getInstance();\r\n      prm.add_endRequest(() => setTimeout(reapply, 0));\r\n      window.Sys?.Application?.add_load?.(() => setTimeout(reapply, 0));\r\n      installed = true;\r\n      dbg(\"WebForms PRM hook installed\");\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  if (wire()) return;\r\n\r\n  // Retry briefly until PRM shows up\r\n  const iv = setInterval(() => {\r\n    if (wire()) clearInterval(iv);\r\n  }, 200);\r\n  setTimeout(() => clearInterval(iv), 8000);\r\n\r\n  // Fallback for older pages\r\n  if (typeof window.__doPostBack === \"function\") {\r\n    const orig = window.__doPostBack;\r\n    window.__doPostBack = function () {\r\n      const r = orig.apply(this, arguments);\r\n      setTimeout(reapply, 0);\r\n      dbg(\"Fallback __doPostBack patch used\");\r\n      return r;\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Convenience boot: compute namespaces, init i18n, set initial lang, and hook WebForms.\r\n * Call this from your orchestrator on DOM ready.\r\n */\r\nexport async function initDoIt({ manifestUrl }) {\r\n  const namespaces = pickNamespaces(new URL(location.href));\r\n  if (!namespaces.length) {\r\n    dbg(\"skip i18n (no namespaces for this page)\");\r\n    return;\r\n  }\r\n\r\n  // Initialize i18n core (it handles both maps and catalogs + a MutationObserver)\r\n  await window.ThriveI18n?.init?.({\r\n    manifestUrl,\r\n    namespaces,\r\n    observeMutations: true,\r\n  });\r\n\r\n  const initial = (\r\n    localStorage.getItem(\"preferredLang\") ||\r\n    document.documentElement.getAttribute(\"data-lang\") ||\r\n    document.documentElement.getAttribute(\"lang\") ||\r\n    \"en\"\r\n  ).toLowerCase();\r\n\r\n  await window.ThriveI18n?.setLangNoReload?.(initial);\r\n  document.documentElement.setAttribute(\r\n    \"data-lang\",\r\n    initial === \"fr\" ? \"fr\" : \"en\"\r\n  );\r\n  document.documentElement.setAttribute(\r\n    \"lang\",\r\n    initial === \"fr\" ? \"fr-CA\" : \"en-CA\"\r\n  );\r\n  dbg(\"initDoIt complete\", { initial, namespaces });\r\n\r\n  installWebFormsHooks();\r\n}\r\n", "// src/features/dynamic-i18n.js\r\n// Page-scoped renders, no MutationObserver (orchestrator/i18n will call runActive)\r\n\r\nconst PAGES = new Map(); // key: path string OR predicate fn -> render fn\r\nlet _debounceTimer = null;\r\n\r\nfunction getLocale() {\r\n  // single source of truth (set by i18n-toggle / i18n core)\r\n  const attr = document.documentElement.getAttribute(\"data-lang\");\r\n  return attr === \"fr\" ? \"fr\" : \"en\";\r\n}\r\n\r\n// ---------- parsers ----------\r\nfunction parseCommunityName(text) {\r\n  const m = String(text)\r\n    .trim()\r\n    .match(/^Invite people to join\\s+(?:the\\s+)?(.+?)(?:\\s+community)?$/i);\r\n  return m ? m[1].trim() : null;\r\n}\r\nfunction parseTotalCount(text) {\r\n  const m = String(text).match(/(\\d+)/);\r\n  return m ? { total: Number(m[1]) } : null;\r\n}\r\nfunction parseRangeLabel(text) {\r\n  const m = String(text)\r\n    .trim()\r\n    .match(/(\\d+)\\D+(\\d+)\\D+(\\d+)/);\r\n  if (!m) return null;\r\n  const [, start, end, total] = m.map(Number);\r\n  return { start, end, total };\r\n}\r\nfunction parseLastJoined(text) {\r\n  const m = String(text)\r\n    .trim()\r\n    .match(/(\\d+)\\s+(day|days|month|months|year|years)/i);\r\n  if (!m) return null;\r\n  const n = Number(m[1]);\r\n  const w = m[2].toLowerCase();\r\n  const unitKey = w.startsWith(\"day\")\r\n    ? \"day\"\r\n    : w.startsWith(\"month\")\r\n    ? \"month\"\r\n    : \"year\";\r\n  return { n, unitKey };\r\n}\r\n\r\n// ---------- localized strings ----------\r\nconst templates = {\r\n  contacts: {\r\n    en: ({ start, end, total }) => `Showing ${start} to ${end} of ${total}`,\r\n    fr: ({ start, end, total }) =>\r\n      `Affichage des \u00E9l\u00E9ments ${start} \u00E0 ${end} sur ${total}`,\r\n  },\r\n  lastJoined: {\r\n    en: ({ n, unit }) => `last person joined ${n} ${unit} ago`,\r\n    fr: ({ n, unit }) => `derni\u00E8re personne inscrite il y a ${n} ${unit}`,\r\n  },\r\n  totalCount: {\r\n    en: ({ total }) => `${total} total`,\r\n    fr: ({ total }) => `${total} au total`,\r\n  },\r\n  rangeWithTotal: {\r\n    en: ({ start, end, total }) => `${start} to ${end} of ${total} total`,\r\n    fr: ({ start, end, total }) => `${start} \u00E0 ${end} sur ${total} au total`,\r\n  },\r\n};\r\n\r\nconst UNITS = {\r\n  en: {\r\n    day: (n) => (n === 1 ? \"day\" : \"days\"),\r\n    month: (n) => (n === 1 ? \"month\" : \"months\"),\r\n    year: (n) => (n === 1 ? \"year\" : \"years\"),\r\n  },\r\n  fr: {\r\n    day: (n) => (n === 1 ? \"jour\" : \"jours\"),\r\n    month: () => \"mois\",\r\n    year: (n) => (n === 1 ? \"an\" : \"ans\"),\r\n  },\r\n};\r\n\r\n// ---------- registry ----------\r\n/**\r\n * Register a page renderer.\r\n * @param {string|((loc: Location)=>boolean)} when - path string (exact) or predicate\r\n * @param {()=>void} render - render function to run when active\r\n */\r\nexport function register(when, render) {\r\n  PAGES.set(when, render);\r\n}\r\n\r\n// export function register(when, render) {\r\n//   const arr = PAGES.get(when) || [];\r\n//   arr.push(render);\r\n//   PAGES.set(when, arr);\r\n// }\r\n\r\nfunction isActive(when) {\r\n  const path = location.pathname.replace(/\\/+$/, \"\") || \"/\";\r\n\r\n  if (typeof when === \"function\") return !!when(location);\r\n  if (when instanceof RegExp) return when.test(path);\r\n\r\n  if (typeof when === \"string\") {\r\n    const wanted = String(when).replace(/\\/+$/, \"\") || \"/\";\r\n    // support \"/people/*\" to match any subpath\r\n    if (wanted.endsWith(\"/*\")) {\r\n      const base = wanted.slice(0, -1); // drop the \"*\"\r\n      return path === base.slice(0, -1) || path.startsWith(base);\r\n    }\r\n    return path === wanted;\r\n  }\r\n  return false;\r\n}\r\n\r\n// function isActive(when) {\r\n//   const path = location.pathname.replace(/\\/+$/, \"\");\r\n//   return typeof when === \"function\"\r\n//     ? !!when(location)\r\n//     : path === String(when).replace(/\\/+$/, \"\");\r\n// }\r\n\r\nexport function activeRender() {\r\n  for (const [when, render] of PAGES) {\r\n    if (isActive(when)) return render;\r\n  }\r\n  return null;\r\n}\r\n\r\n/** Run the active page's render now (debounced to next tick). */\r\nexport function runActive() {\r\n  clearTimeout(_debounceTimer);\r\n  _debounceTimer = setTimeout(() => {\r\n    const render = activeRender();\r\n    if (render) render();\r\n  }, 0);\r\n}\r\n\r\n/** Initialize: run once on DOM ready and wire to langchanges. */\r\nexport function initDynamic() {\r\n  const boot = () => runActive();\r\n\r\n  if (document.readyState === \"loading\") {\r\n    document.addEventListener(\"DOMContentLoaded\", boot, { once: true });\r\n  } else {\r\n    boot();\r\n  }\r\n\r\n  // Re-render current page when language changes\r\n  window.addEventListener(\"langchange\", () => runActive());\r\n}\r\n\r\n// ---------------- registered pages ----------------\r\n\r\n//PROFILE TAB START\r\n// Shared helper: translate dynamic <ul> items using an EN\u2192FR map\r\n\r\nfunction translateDynamicUl(ulId, map, parentId, eventName) {\r\n  // default to your event name\r\n  eventName = eventName || \"langchange\";\r\n\r\n  function getLocaleSafe() {\r\n    try {\r\n      // prefer event-provided value; fallback to getLocale/html lang\r\n      return (\r\n        (typeof getLocale === \"function\" && getLocale()) ||\r\n        document.documentElement.lang ||\r\n        \"en\"\r\n      );\r\n    } catch (e) {\r\n      return document.documentElement.lang || \"en\";\r\n    }\r\n  }\r\n\r\n  function norm(s) {\r\n    return (s || \"\").replace(/\\s+/g, \" \").trim();\r\n  }\r\n\r\n  function applyForLocale(locale) {\r\n    var ul = document.getElementById(ulId);\r\n    if (!ul) {\r\n      // console.log(\"applyForLocale CANNOT FIND \", ulId, locale);\r\n      return;\r\n    }\r\n    // console.log(\"applyForLocale FOUND \", ulId, locale);\r\n    var lis = ul.querySelectorAll(\"li\");\r\n    for (var i = 0; i < lis.length; i++) {\r\n      var li = lis[i];\r\n      if (!li.dataset.i18nOrig) li.dataset.i18nOrig = norm(li.textContent);\r\n      var en = li.dataset.i18nOrig;\r\n      var fr = map[en];\r\n      if (locale === \"fr\" && fr) {\r\n        if (li.textContent !== fr) li.textContent = fr;\r\n        li.dataset.i18nApplied = \"1\";\r\n      } else {\r\n        if (li.textContent !== en) li.textContent = en;\r\n        li.dataset.i18nApplied = \"\";\r\n      }\r\n    }\r\n  }\r\n\r\n  function once() {\r\n    applyForLocale(getLocaleSafe());\r\n  }\r\n\r\n  var anchor = (parentId && document.getElementById(parentId)) || document.body;\r\n\r\n  // initial pass\r\n  if (document.readyState === \"loading\") {\r\n    // console.log(\"loading\");\r\n    document.addEventListener(\"DOMContentLoaded\", once, { once: true });\r\n  } else {\r\n    // console.log(\"once\");\r\n    once();\r\n  }\r\n\r\n  // listen to your custom language event\r\n  window.addEventListener(eventName, function (ev) {\r\n    // support {detail:{lang}} and {detail:{locale}}\r\n    var next =\r\n      (ev && ev.detail && (ev.detail.lang || ev.detail.locale)) ||\r\n      getLocaleSafe();\r\n    applyForLocale(next);\r\n  });\r\n\r\n  // also react when <html lang=\"...\"> changes (in case you set it)\r\n  if (window.MutationObserver) {\r\n    var langMo = new MutationObserver(once);\r\n    langMo.observe(document.documentElement, {\r\n      attributes: true,\r\n      attributeFilter: [\"lang\"],\r\n    });\r\n  }\r\n\r\n  // observe DOM under a stable parent so UL replacements get translated\r\n  if (window.MutationObserver) {\r\n    var mo = new MutationObserver(once);\r\n    mo.observe(anchor, { childList: true, subtree: true, characterData: true });\r\n  }\r\n\r\n  // survive ASP.NET WebForms partial postbacks\r\n  if (window.Sys && Sys.WebForms && Sys.WebForms.PageRequestManager) {\r\n    try {\r\n      var prm = Sys.WebForms.PageRequestManager.getInstance();\r\n      prm.add_endRequest(once);\r\n    } catch (e) {}\r\n  }\r\n}\r\n\r\n// function translateDynamicUl(ulId, map, parentId) {\r\n//   function getLocaleSafe() {\r\n//     try {\r\n//       return (typeof getLocale === \"function\" && getLocale()) || \"en\";\r\n//     } catch (e) {\r\n//       return \"en\";\r\n//     }\r\n//   }\r\n//   function normalize(s) {\r\n//     return (s || \"\").replace(/\\s+/g, \" \").trim();\r\n//   }\r\n\r\n//   function once() {\r\n//     if (getLocaleSafe() !== \"fr\") return;\r\n//     var ul = document.getElementById(ulId);\r\n//     if (!ul) return;\r\n//     var lis = ul.querySelectorAll(\"li\");\r\n//     for (var i = 0; i < lis.length; i++) {\r\n//       var li = lis[i];\r\n//       if (li.dataset.i18nApplied === \"1\") continue;\r\n//       var en = normalize(li.textContent);\r\n//       var fr = map[en];\r\n//       if (fr) {\r\n//         li.textContent = fr;\r\n//         li.dataset.i18nApplied = \"1\";\r\n//       }\r\n//     }\r\n//   }\r\n\r\n//   var anchor = (parentId && document.getElementById(parentId)) || document.body;\r\n\r\n//   // Initial pass\r\n//   if (document.readyState === \"loading\") {\r\n//     document.addEventListener(\"DOMContentLoaded\", once);\r\n//   } else {\r\n//     once();\r\n//   }\r\n\r\n//   // Observe the stable parent so we catch UL replacement\r\n//   var mo;\r\n//   if (window.MutationObserver) {\r\n//     var rebind = function () {\r\n//       if (mo) mo.disconnect();\r\n//       mo = new MutationObserver(once);\r\n//       mo.observe(anchor, {\r\n//         childList: true,\r\n//         subtree: true,\r\n//         characterData: true,\r\n//       });\r\n//     };\r\n//     rebind();\r\n//   }\r\n\r\n//   // Re-run after WebForms partial postbacks (DOM replaced)\r\n//   if (window.Sys && Sys.WebForms && Sys.WebForms.PageRequestManager) {\r\n//     try {\r\n//       var prm = Sys.WebForms.PageRequestManager.getInstance();\r\n//       prm.add_endRequest(function () {\r\n//         once();\r\n//         if (mo) {\r\n//           mo.disconnect();\r\n//           mo.observe(anchor, {\r\n//             childList: true,\r\n//             subtree: true,\r\n//             characterData: true,\r\n//           });\r\n//         }\r\n//       });\r\n//     } catch (e) {}\r\n//   }\r\n\r\n//   // Small retry to catch ultra-late inserts (optional)\r\n//   var tries = 8,\r\n//     iv = setInterval(function () {\r\n//       once();\r\n//       if (--tries <= 0) clearInterval(iv);\r\n//     }, 250);\r\n// }\r\n\r\nconst PROVINCE_MAP = {\r\n  \"Alberta (AB)\": \"Alberta (AB)\",\r\n  \"British Columbia (BC)\": \"Colombie-Britannique (C.-B.)\",\r\n  \"Manitoba (MB)\": \"Manitoba (MB)\",\r\n  \"New Brunswick (NB)\": \"Nouveau-Brunswick (N.-B.)\",\r\n  \"Newfoundland and Labrador (NL)\": \"Terre-Neuve-et-Labrador (T.-N.-L.)\",\r\n  \"Northwest Territories (NT)\": \"Territoires du Nord-Ouest (T.N.-O.)\",\r\n  \"Nova Scotia (NS)\": \"Nouvelle-\u00C9cosse (N.-\u00C9.)\",\r\n  \"Nunavut (NU)\": \"Nunavut (NU)\",\r\n  \"Ontario (ON)\": \"Ontario (ON)\",\r\n  \"Prince Edward Island (PE)\": \"\u00CEle-du-Prince-\u00C9douard (\u00CE.-P.-\u00C9.)\",\r\n  \"Quebec (QC)\": \"Qu\u00E9bec (QC)\",\r\n  \"Saskatchewan (SK)\": \"Saskatchewan (SK)\",\r\n  \"Yukon (YT)\": \"Yukon (YT)\",\r\n  Other: \"Autre\",\r\n  \"Not Specified\": \"Non pr\u00E9cis\u00E9\",\r\n};\r\n\r\nconst SECTOR_MAP = {\r\n  Other: \"Autre\",\r\n  Academia: \"Milieu universitaire\",\r\n  Consulting: \"Services-conseils\",\r\n  \"Federal government\": \"Gouvernement f\u00E9d\u00E9ral\",\r\n  Foundation: \"Fondation\",\r\n  \"Municipal government\": \"Administration municipale\",\r\n  \"Non-profit sector\": \"Secteur sans but lucratif\",\r\n  \"Private sector\": \"Secteur priv\u00E9\",\r\n  \"Provincial government\": \"Gouvernement provincial\",\r\n  \"Not Specified\": \"Non pr\u00E9cis\u00E9\",\r\n};\r\n\r\nconst GEO_MAP = {\r\n  \"Large urban (100,000 or more)\": \"Grande zone urbaine (100\u2009000 ou plus)\",\r\n  \"Medium urban (30,000 to 99,999)\": \"Zone urbaine moyenne (30\u2009000 \u00E0 99\u2009999)\",\r\n  \"Small urban (less than 30,000)\": \"Petite zone urbaine (moins de 30\u2009000)\",\r\n  Northern: \"Nordique\",\r\n  Rural: \"Rurale\",\r\n};\r\n\r\n// Financial Empowerment Services Offered (EN \u2192 FR)\r\nconst FE_OFFERED_MAP = {\r\n  \"Tax-filing support (e.g. free tax clinics)\":\r\n    \"Aide \u00E0 la d\u00E9claration de revenus (p. ex. cliniques d\u2019imp\u00F4t gratuites)\",\r\n  \"Help accessing benefits\": \"Aide pour acc\u00E9der aux prestations\",\r\n  \"One-on-one financial coaching (e.g. financial goal setting and action planning)\":\r\n    \"Coaching financier individuel (p. ex. \u00E9tablissement d\u2019objectifs financiers et plan d\u2019action)\",\r\n  \"Financial counselling and problem solving (including debt management)\":\r\n    \"Conseils financiers et r\u00E9solution de probl\u00E8mes (y compris la gestion des dettes)\",\r\n  \"Financial education\": \"\u00C9ducation financi\u00E8re\",\r\n  None: \"Aucun\",\r\n  Other: \"Autre\",\r\n};\r\n\r\n// Other Services Offered (EN \u2192 FR)\r\nconst OTHER_SERVICES_MAP = {\r\n  \"Access to ID\": \"Acc\u00E8s aux pi\u00E8ces d\u2019identit\u00E9\",\r\n  \"Banking Access Support\": \"Soutien \u00E0 l\u2019acc\u00E8s aux services bancaires\",\r\n  \"Budget Counselling\": \"Conseils budg\u00E9taires\",\r\n  \"Consumer Advocacy\": \"D\u00E9fense des consommateurs\",\r\n  \"Debt Management\": \"Gestion des dettes\",\r\n  \"Eviction Prevention Loan Program\":\r\n    \"Programme de pr\u00EAts pour pr\u00E9venir les expulsions\",\r\n  \"Housing or Homelessness Support\": \"Soutien au logement ou \u00E0 l\u2019itin\u00E9rance\",\r\n  \"Income Support\": \"Aide au revenu\",\r\n  \"RDSP Info & Support\": \"Renseignements et soutien sur le REEI\",\r\n  \"RESP Info & Support\": \"Renseignements et soutien sur le REEE\",\r\n  None: \"Aucun\",\r\n  Other: \"Autre\",\r\n};\r\n\r\n// Language Preference (EN \u2192 FR)\r\nconst LANG_PREF_MAP = {\r\n  English: \"Anglais\",\r\n  French: \"Fran\u00E7ais\",\r\n};\r\n\r\n// Populations Served (EN \u2192 FR)\r\nconst POPS_MAP = {\r\n  \"Older people, Elders, or Seniors (65+ years old)\":\r\n    \"Personnes \u00E2g\u00E9es, a\u00EEn\u00E9s et a\u00EEn\u00E9es (65 ans et plus)\",\r\n  \"Youth (15-30 years old)\": \"Jeunes (15 \u00E0 30 ans)\",\r\n  \"Racialized people\": \"Personnes racis\u00E9es\",\r\n  \"Black communities\": \"Communaut\u00E9s noires\",\r\n  \"Newcomers, Refugees, or Non-Status people\":\r\n    \"Nouveaux arrivants, r\u00E9fugi\u00E9s ou personnes sans statut\",\r\n  \"First Nations, M\u00E9tis, and Inuit\": \"Premi\u00E8res Nations, M\u00E9tis et Inuit\",\r\n  \"Those living with disabilities\": \"Personnes en situation de handicap\",\r\n  \"Those who are unhoused\": \"Personnes sans logement\",\r\n  \"Those living on low incomes\": \"Personnes \u00E0 faible revenu\",\r\n  Women: \"Femmes\",\r\n  \"2SLGBTQI+\": \"2SLGBTQI+\",\r\n  \"Northern Communities\": \"Communaut\u00E9s nordiques\",\r\n  \"Rural or Remote Communities\": \"Communaut\u00E9s rurales ou \u00E9loign\u00E9es\",\r\n  \"Official language minority community\":\r\n    \"Communaut\u00E9 de langue officielle en situation minoritaire\",\r\n  Other: \"Autre\",\r\n};\r\n\r\nregister(\r\n  (loc) =>\r\n    loc.pathname.startsWith(\"/people/\") || loc.pathname.startsWith(\"/profile\"),\r\n  function () {\r\n    // console.log(\"DEBUG CALLED AS GEO_MAP\");\r\n\r\n    translateDynamicUl(\r\n      \"MainCopy_ctl32_ulDemographicItems\",\r\n      PROVINCE_MAP,\r\n      \"MainCopy_ctl32_ContactDemographicUpdatePanel\",\r\n      \"langchange\" // your event\r\n    );\r\n\r\n    translateDynamicUl(\r\n      \"MainCopy_ctl34_ulDemographicItems\",\r\n      GEO_MAP,\r\n      \"MainCopy_ctl34_ContactDemographicUpdatePanel\",\r\n      \"langchange\" // your event\r\n    );\r\n\r\n    translateDynamicUl(\r\n      \"MainCopy_ctl36_ulDemographicItems\",\r\n      SECTOR_MAP,\r\n      \"MainCopy_ctl36_ContactDemographicUpdatePanel\",\r\n      \"langchange\" // your event\r\n    );\r\n\r\n    translateDynamicUl(\r\n      \"MainCopy_ctl41_ulDemographicItems\",\r\n      FE_OFFERED_MAP,\r\n      \"MainCopy_ctl41_ContactDemographicUpdatePanel\",\r\n      \"langchange\" // your event\r\n    );\r\n\r\n    translateDynamicUl(\r\n      \"MainCopy_ctl43_ulDemographicItems\",\r\n      OTHER_SERVICES_MAP,\r\n      \"MainCopy_ctl43_ContactDemographicUpdatePanel\",\r\n      \"langchange\" // your event\r\n    );\r\n\r\n    translateDynamicUl(\r\n      \"MainCopy_ctl45_ulDemographicItems\",\r\n      LANG_PREF_MAP,\r\n      \"MainCopy_ctl45_ContactDemographicUpdatePanel\",\r\n      \"langchange\" // your event\r\n    );\r\n\r\n    translateDynamicUl(\r\n      \"MainCopy_ctl38_ulDemographicItems\",\r\n      POPS_MAP,\r\n      \"MainCopy_ctl38_ContactDemographicUpdatePanel\",\r\n      \"langchange\" // your event\r\n    );\r\n\r\n    // wait ~2s, then refresh the picker\r\n    setTimeout(() => {\r\n      $(\"#MainCopy_ctl32_lbDemographicItems\").selectpicker(\"refresh\");\r\n      $(\"#MainCopy_ctl36_lbDemographicItems\").selectpicker(\"refresh\");\r\n    }, 2000);\r\n  }\r\n);\r\n\r\nregister(\r\n  (loc) => loc.pathname.startsWith(\"/login\"),\r\n  function () {\r\n    // wait ~2s, then refresh the picker\r\n\r\n    setTimeout(() => {\r\n      if (!$.fn.selectpicker) return; // plugin not loaded yet\r\n\r\n      const ids = [\r\n        \"0bca3586-218f-43b3-b059-0199734a100b-select\", // Org Location\r\n        \"d4aedf2d-a642-4b70-81dd-0199734cd5a1-select\", // Sector\r\n        \"7ef9a3b6-0f46-4dac-b38b-0199734efe10-select\", // FE Services\r\n        \"172d3906-c563-42c3-bff0-0199735b5682-select\", // Other Services\r\n        \"303063c6-1cd6-4d75-8e3b-0199735e0e0d-select\", // Populations\r\n        \"eb4436bb-e703-484c-afc7-0199736d34bf-select\", // Geographic Areas\r\n        \"820d636e-9fed-4604-869e-0199736e70b7-select\", // Language Pref\r\n      ];\r\n\r\n      ids.forEach((id) => {\r\n        const $el = $(`[id=\"${id}\"]`);\r\n        if ($el.length) $el.selectpicker(\"refresh\");\r\n      });\r\n    }, 2000);\r\n\r\n    // setTimeout(() => {\r\n    //   $('[id=\"0bca3586-218f-43b3-b059-0199734a100b-select\"]').selectpicker(\r\n    //     \"refresh\"\r\n    //   ); // Organization Location\r\n    //   $('[id=\"d4aedf2d-a642-4b70-81dd-0199734cd5a1-select\"]').selectpicker(\r\n    //     \"refresh\"\r\n    //   ); // Sector\r\n    //   $('[id=\"7ef9a3b6-0f46-4dac-b38b-0199734efe10-select\"]').selectpicker(\r\n    //     \"refresh\"\r\n    //   ); // FE Services\r\n    //   $('[id=\"172d3906-c563-42c3-bff0-0199735b5682-select\"]').selectpicker(\r\n    //     \"refresh\"\r\n    //   ); // Other Services\r\n    //   $('[id=\"303063c6-1cd6-4d75-8e3b-0199735e0e0d-select\"]').selectpicker(\r\n    //     \"refresh\"\r\n    //   ); // Populations\r\n    //   $('[id=\"eb4436bb-e703-484c-afc7-0199736d34bf-select\"]').selectpicker(\r\n    //     \"refresh\"\r\n    //   ); // Geographic Areas\r\n    //   $('[id=\"820d636e-9fed-4604-869e-0199736e70b7-select\"]').selectpicker(\r\n    //     \"refresh\"\r\n    //   ); // Language Pref\r\n    // }, 2000);\r\n\r\n    // setTimeout(() => {\r\n    //   $(\"#0bca3586-218f-43b3-b059-0199734a100b-select\").selectpicker(\"refresh\"); //Organization Location\r\n    //   $(\"#d4aedf2d-a642-4b70-81dd-0199734cd5a1-select\").selectpicker(\"refresh\"); //Sector\r\n    //   $(\"#7ef9a3b6-0f46-4dac-b38b-0199734efe10-select\").selectpicker(\"refresh\"); //Financial Empowerment Services Offered\r\n    //   $(\"#172d3906-c563-42c3-bff0-0199735b5682-select\").selectpicker(\"refresh\"); //Other Services Offered\r\n    //   $(\"#303063c6-1cd6-4d75-8e3b-0199735e0e0d-select\").selectpicker(\"refresh\"); //Populations Served\r\n    //   $(\"#eb4436bb-e703-484c-afc7-0199736d34bf-select\").selectpicker(\"refresh\"); //Geographic Area(s) Served\r\n    //   $(\"#820d636e-9fed-4604-869e-0199736e70b7-select\").selectpicker(\"refresh\"); //Language Preference\r\n    // }, 2000);\r\n  }\r\n);\r\n\r\n// register(\r\n//   (loc) =>\r\n//     loc.pathname.startsWith(\"/people/\") || loc.pathname.startsWith(\"/profile\"),\r\n//   function () {\r\n//     console.log(\"DEBUG CALLED AS FE_OFFERED_MAP\");\r\n//     translateDynamicUl(\r\n//       \"MainCopy_ctl41_ulDemographicItems\",\r\n//       FE_OFFERED_MAP,\r\n//       \"MainCopy_ctl41_ContactDemographicUpdatePanel\",\r\n//       \"langchange\" // your event\r\n//     );\r\n//   }\r\n// );\r\n\r\n// register(\r\n//   (loc) =>\r\n//     loc.pathname.startsWith(\"/people/\") || loc.pathname.startsWith(\"/profile\"),\r\n//   function () {\r\n//     console.log(\"DEBUG CALLED AS OTHER_SERVICES_MAP\");\r\n//     translateDynamicUl(\r\n//       \"MainCopy_ctl43_ulDemographicItems\",\r\n//       OTHER_SERVICES_MAP,\r\n//       \"MainCopy_ctl43_ContactDemographicUpdatePanel\",\r\n//       \"langchange\" // your event\r\n//     );\r\n//   }\r\n// );\r\n\r\n// register(\r\n//   (loc) =>\r\n//     loc.pathname.startsWith(\"/people/\") || loc.pathname.startsWith(\"/profile\"),\r\n//   function () {\r\n//     console.log(\"DEBUG CALLED AS LANG_PREF_MAP\");\r\n//     translateDynamicUl(\r\n//       \"MainCopy_ctl45_ulDemographicItems\",\r\n//       LANG_PREF_MAP,\r\n//       \"MainCopy_ctl45_ContactDemographicUpdatePanel\",\r\n//       \"langchange\" // your event\r\n//     );\r\n//   }\r\n// );\r\n\r\n// register(\r\n//   (loc) =>\r\n//     loc.pathname.startsWith(\"/people/\") || loc.pathname.startsWith(\"/profile\"),\r\n//   function () {\r\n//     console.log(\"DEBUG CALLED POPS_MAP\");\r\n//     translateDynamicUl(\r\n//       \"MainCopy_ctl38_ulDemographicItems\",\r\n//       POPS_MAP,\r\n//       \"MainCopy_ctl38_ContactDemographicUpdatePanel\",\r\n//       \"langchange\" // your event\r\n//     );\r\n//   }\r\n// );\r\n\r\n// /advisory-committee\r\nregister(\"/advisory-committee\", function renderAdvisoryCommitteeTitle() {\r\n  const el = document.querySelector(\"#PageTitleH1\");\r\n  if (!el) return;\r\n  const MAP = {\r\n    en: \"Meet the Resilient Futures Advisory Committee\",\r\n    fr: \"Rencontrez le comit\u00E9 consultatif de l\u2019initiative Un avenir r\u00E9silient\",\r\n  };\r\n  const next = MAP[getLocale()] || MAP.en;\r\n  if (el.textContent.trim() !== next) el.textContent = next;\r\n});\r\n\r\n// /sandboxmicrosite/communities/community-home/invite-community\r\n// register(\r\n//   \"/sandboxmicrosite/communities/community-home/invite-community\",\r\n//   function renderInviteCommunity() {\r\n//     const host = document.querySelector(\r\n//       \"#MainCopy_ctl04_InviteToCommunityLabel\"\r\n//     );\r\n//     if (!host) return;\r\n//     const target = host.querySelector(\"strong\") || host;\r\n//     const name =\r\n//       parseCommunityName(target.textContent) || target.textContent.trim();\r\n//     const loc = getLocale();\r\n//     const next =\r\n//       loc === \"fr\"\r\n//         ? `Invitez des personnes \u00E0 rejoindre la communaut\u00E9 ${name}`\r\n//         : `Invite people to join ${name}`;\r\n//     if (target.textContent !== next) target.textContent = next;\r\n//   }\r\n// );\r\n\r\n// /profile/connections/contacts\r\n// register(\"/profile/connections/contacts\", function renderContacts() {\r\n//   const el = document.querySelector(\"[id$='FindContacts_ShowingLabel']\");\r\n//   if (!el) return;\r\n//   const data = parseRangeLabel(el.textContent);\r\n//   if (!data) return;\r\n//   const t = templates.contacts[getLocale()] || templates.contacts.en;\r\n//   const next = t(data);\r\n//   if (el.textContent !== next) el.textContent = next;\r\n// });\r\n\r\n// /profile/connections/communitiesnode\r\n// register(\r\n//   \"/profile/connections/communitiesnode\",\r\n//   function renderCommunitiesNode() {\r\n//     const loc = getLocale();\r\n//     const unitFn = UNITS[loc] || UNITS.en;\r\n//     const fmtLast = templates.lastJoined[loc] || templates.lastJoined.en;\r\n\r\n//     // A) \u201Clast person joined \u2026 ago\u201D\r\n//     document\r\n//       .querySelectorAll(\r\n//         \"[id^='MainCopy_ctl29_lstCommunityList_lblLastUpdated_']\"\r\n//       )\r\n//       .forEach((el) => {\r\n//         const data = parseLastJoined(el.textContent);\r\n//         if (!data) return;\r\n//         const unit = unitFn[data.unitKey](data.n);\r\n//         const next = fmtLast({ n: data.n, unit });\r\n//         if (el.textContent !== next) el.textContent = next;\r\n//       });\r\n\r\n//     // B) \u201C3 total\u201D\r\n//     const totalEl = document.querySelector(\r\n//       \"#MainCopy_ctl29_lbCommunityCount .Count\"\r\n//     );\r\n//     if (totalEl) {\r\n//       const data = parseTotalCount(totalEl.textContent);\r\n//       if (data) {\r\n//         const fmtTotal = templates.totalCount[loc] || templates.totalCount.en;\r\n//         const next = fmtTotal(data);\r\n//         if (totalEl.textContent !== next) totalEl.textContent = next;\r\n//       }\r\n//     }\r\n\r\n//     // C) \u201CNo Results Found\u201D (only when no result rows)\r\n//     (function translateNoResultsSibling() {\r\n//       const container = document.getElementById(\r\n//         \"MainCopy_ctl29_AllCommunitiesContainer\"\r\n//       );\r\n//       if (!container) return;\r\n//       const parent = container.parentElement || container;\r\n\r\n//       const siblings = Array.from(parent.childNodes).filter(\r\n//         (n) => n !== container\r\n//       );\r\n\r\n//       const hasResults = siblings.some(\r\n//         (n) =>\r\n//           n.nodeType === 1 &&\r\n//           n.classList?.contains(\"row\") &&\r\n//           n.classList?.contains(\"rowContainer\") &&\r\n//           n.classList?.contains(\"community-list\")\r\n//       );\r\n//       if (hasResults) return;\r\n\r\n//       const placeholder = siblings.find((n) => {\r\n//         if (n.nodeType === 3)\r\n//           return /^\\s*no\\s+results\\s+found\\s*$/i.test(n.textContent);\r\n//         if (n.nodeType === 1)\r\n//           return /^no\\s+results\\s+found$/i.test((n.textContent || \"\").trim());\r\n//         return false;\r\n//       });\r\n//       if (!placeholder) return;\r\n\r\n//       const msg = loc === \"fr\" ? \"Aucun r\u00E9sultat\" : \"No Results Found\";\r\n//       if (placeholder.nodeType === 3) {\r\n//         placeholder.textContent = \" \" + msg + \" \";\r\n//       } else {\r\n//         placeholder.textContent = msg;\r\n//       }\r\n//     })();\r\n//   }\r\n// );\r\n\r\n// /profile/connections/following-connections\r\n// register(\r\n//   \"/profile/connections/following-connections\",\r\n//   function renderFollowingConnections() {\r\n//     const sel =\r\n//       \"[id^='FollowedContent_'] .contributions-list-header .text-muted\";\r\n//     const loc = getLocale();\r\n//     document.querySelectorAll(sel).forEach((el) => {\r\n//       const data = parseRangeLabel(el.textContent);\r\n//       if (!data) return;\r\n//       const t = templates.contacts[loc] || templates.contacts.en;\r\n//       const next = t(data);\r\n//       if (el.textContent !== next) el.textContent = next;\r\n//     });\r\n//   }\r\n// );\r\n\r\n// /profile/contributions/contributions-list\r\n// register(\r\n//   \"/profile/contributions/contributions-list\",\r\n//   function renderContributionsList() {\r\n//     const el = document.querySelector(\r\n//       \"#MainCopy_ctl29_SearchResultStatus .ResultStatus.text-muted\"\r\n//     );\r\n//     if (!el) return;\r\n//     const raw = el.textContent;\r\n//     const data = parseRangeLabel(raw);\r\n//     if (!data) return;\r\n\r\n//     const loc = getLocale();\r\n//     const hasWordTotal = /\\btotal\\b/i.test(raw);\r\n//     const t = hasWordTotal\r\n//       ? templates.rangeWithTotal[loc] || templates.rangeWithTotal.en\r\n//       : templates.contacts[loc] || templates.contacts.en;\r\n\r\n//     const next = t(data);\r\n//     if (el.textContent !== next) el.textContent = next;\r\n//   }\r\n// );\r\n", "// src/index.js\r\nimport { initToggle } from \"./core/i18n-toggle.js\";\r\nimport { initI18n } from \"./core/i18n.js\"; // your consolidated core\r\n\r\nimport { pickNamespaces } from \"./features/doit.js\";\r\nimport { initDynamic } from \"./features/dynamic-i18n.js\";\r\n\r\nfunction boot() {\r\n  initToggle();\r\n\r\n  // If you prefer orchestration here instead of inside initDoIt:\r\n  const namespaces = pickNamespaces();\r\n  initI18n({\r\n    manifestUrl:\r\n      \"https://prospercanada.github.io/i18n-thrive/i18n/manifest.json\",\r\n    namespaces,\r\n    observeMutations: true,\r\n  });\r\n\r\n  // DISABLE FOR NOW, PROGRESSIVELY ADD LATER\r\n  initDynamic(); // page-scoped text transforms (reruns on langchange)\r\n}\r\n\r\ndocument.readyState === \"loading\"\r\n  ? document.addEventListener(\"DOMContentLoaded\", boot, { once: true })\r\n  : boot();\r\n\r\n// (Optional) expose a tiny global for consoles/tests\r\nwindow.i18nThrive = { pickNamespaces };\r\n"],
  "mappings": "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",
  "names": ["_inited", "LANG_STORAGE_KEY", "LANGS", "normalize", "v", "getCurrentLang", "e", "setDocumentLang", "code", "c", "setLanguage", "lang", "notifyAlways", "_a", "_b", "next", "current", "err", "findNav", "renderToggle", "currentLang", "nav", "li", "other", "l", "target", "_disconnectMo", "startObserver", "mo", "initToggle", "ready", "state", "STORE_KEY", "ATTRS", "normalizeLang", "v", "setDocumentLang", "lang", "code", "firstTextNode", "el", "sameHTML", "a", "b", "setFirstText", "txt", "tn", "jsonMem", "JSON_TTL_MS", "JSON_CACHE_PREFIX", "LOG", "log", "a", "lsGet", "key", "lsSet", "value", "e", "cacheKey", "url", "JSON_CACHE_PREFIX", "isFresh", "ts", "ttlMs", "loadJSON", "JSON_TTL_MS", "retries", "jsonMem", "k", "cached", "lsGet", "log", "p", "lastErr", "attempt", "r", "delay", "res", "json", "lsSet", "e", "_manifestP", "getManifest", "url", "loadJSON", "nsMapCache", "getMap", "manifestUrl", "ns", "p", "file", "base", "catalogCache", "loadCatalogs", "namespaces", "lang", "manifest", "promises", "key", "rel", "parts", "parseAttrPairs", "str", "map", "part", "s", "attr", "stringifyAttrPairs", "a", "b", "attachMaps", "entries", "root", "e", "selector", "type", "nodes", "el", "cur", "next", "applyToElement", "tmap", "val", "sig", "state", "sameHTML", "txt", "tn", "firstTextNode", "setFirstText", "raw", "pairs", "k", "ATTRS", "applyAll", "loadAndApply", "_a", "normalizeLang", "STORE_KEY", "maps", "_flushScheduled", "_pendingRoots", "scheduleRoot", "flushPending", "roots", "initI18n", "opts", "initial", "setDocumentLang", "setLangNoReload", "records", "m", "n", "t", "fmtNumber", "o", "fmtDate", "d", "dt", "__debug", "initI18n", "setLangNoReload", "t", "fmtNumber", "fmtDate", "__debug", "state", "getParamCI", "url", "name", "target", "k", "v", "pickNamespaces", "currentUrlOrPath", "path", "section", "out", "ENABLE_I18N", "ALLOWED", "add", "ns", "list", "i", "n", "PAGES", "_debounceTimer", "getLocale", "register", "when", "render", "PAGES", "isActive", "path", "wanted", "base", "activeRender", "runActive", "_debounceTimer", "initDynamic", "boot", "translateDynamicUl", "ulId", "map", "parentId", "eventName", "getLocaleSafe", "getLocale", "e", "norm", "s", "applyForLocale", "locale", "ul", "lis", "i", "li", "en", "fr", "once", "anchor", "ev", "next", "langMo", "mo", "prm", "PROVINCE_MAP", "SECTOR_MAP", "GEO_MAP", "FE_OFFERED_MAP", "OTHER_SERVICES_MAP", "LANG_PREF_MAP", "POPS_MAP", "loc", "id", "$el", "el", "MAP", "boot", "initToggle", "namespaces", "pickNamespaces", "initI18n", "initDynamic"]
}
